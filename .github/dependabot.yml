# yaml-language-server: $schema=https://json.schemastore.org/dependabot-2.0.json
version: 2
updates:
  # === NPM DEPENDENCIES ===
  # Configuration for the main application's npm packages.
  - package-ecosystem: "npm"
    directory: "/"

    # Tune cadence & windows: Set weekly updates at a quiet time (Tue 9 AM ET).
    schedule:
      interval: "weekly"
      day: "tuesday"
      time: "09:00"
      timezone: "America/New_York"

    # Cap the firehose: Limit open PRs to prevent overwhelming the team.
    open-pull-requests-limit: 3

    # Housekeeping: Apply labels, use conventional commits, and auto-rebase.
    labels:
      - "dependencies"
      - "dependabot"
    commit-message:
      prefix: "chore"
      include: "scope"
    rebase-strategy: "auto"

    # Group to cut PR count: Combine safe minor/patch updates, but keep majors separate.
    groups:
      # Group related development tools for minor and patch updates.
      dev-tools-minor-patch:
        dependency-type: "development"
        update-types:
          - "minor"
          - "patch"
        patterns:
          - "eslint"
          - "@eslint/*"
          - "prettier"
          - "typescript"
          - "vitest"
          - "jest*"
      
      # Group all production dependencies for minor and patch updates.
      runtime-minor-patch:
        dependency-type: "production"
        update-types:
          - "minor"
          - "patch"

    # Target scope: Fine-tune which dependencies and versions to update.
    # 1. Ignore chatty patch bumps, e.g., for eslint during a release freeze.
    ignore:
      - dependency-name: "eslint*"
        update-types: ["version-update:semver-patch"]

    # 2. Allow only direct dependencies for a repo with limited test coverage.
    allow:
      - dependency-type: "direct"

  # === GITHUB ACTIONS ===
  # Keep GitHub Actions up to date on a lighter, monthly cadence.
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "monthly"
    open-pull-requests-limit: 2
    labels:
      - "ci"
      - "dependencies"
